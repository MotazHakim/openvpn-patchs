{"payload":{"allShortcutsEnabled":true,"fileTree":{"third_party/sources/openvpn/openvpn-2.6.4/patches":{"items":[{"name":"02-tunnelblick-openvpn_xorpatch-a.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/02-tunnelblick-openvpn_xorpatch-a.diff","contentType":"file"},{"name":"03-tunnelblick-openvpn_xorpatch-b.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff","contentType":"file"},{"name":"04-tunnelblick-openvpn_xorpatch-c.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/04-tunnelblick-openvpn_xorpatch-c.diff","contentType":"file"},{"name":"05-tunnelblick-openvpn_xorpatch-d.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff","contentType":"file"},{"name":"06-tunnelblick-openvpn_xorpatch-e.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff","contentType":"file"},{"name":"10-route-gateway-dhcp.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/10-route-gateway-dhcp.diff","contentType":"file"},{"name":"11-apple-iouserethernet.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/11-apple-iouserethernet.diff","contentType":"file"}],"totalCount":7},"third_party/sources/openvpn/openvpn-2.6.4":{"items":[{"name":"patches","path":"third_party/sources/openvpn/openvpn-2.6.4/patches","contentType":"directory"},{"name":"configure-options.txt","path":"third_party/sources/openvpn/openvpn-2.6.4/configure-options.txt","contentType":"file"},{"name":"openvpn-2.6.4.tar.gz","path":"third_party/sources/openvpn/openvpn-2.6.4/openvpn-2.6.4.tar.gz","contentType":"file"}],"totalCount":3},"third_party/sources/openvpn":{"items":[{"name":"openvpn-2.4.12","path":"third_party/sources/openvpn/openvpn-2.4.12","contentType":"directory"},{"name":"openvpn-2.5.9","path":"third_party/sources/openvpn/openvpn-2.5.9","contentType":"directory"},{"name":"openvpn-2.6.4","path":"third_party/sources/openvpn/openvpn-2.6.4","contentType":"directory"}],"totalCount":3},"third_party/sources":{"items":[{"name":"easy-rsa","path":"third_party/sources/easy-rsa","contentType":"directory"},{"name":"openvpn","path":"third_party/sources/openvpn","contentType":"directory"},{"name":"patches","path":"third_party/sources/patches","contentType":"directory"},{"name":"tuntap","path":"third_party/sources/tuntap","contentType":"directory"},{"name":"Sparkle-077c64419f9460263bad99ab24dff962a103b1e2.zip","path":"third_party/sources/Sparkle-077c64419f9460263bad99ab24dff962a103b1e2.zip","contentType":"file"},{"name":"lz4-1.9.3.tar.gz","path":"third_party/sources/lz4-1.9.3.tar.gz","contentType":"file"},{"name":"lzo-2.10.tar.gz","path":"third_party/sources/lzo-2.10.tar.gz","contentType":"file"},{"name":"openssl-1.1.1u.tar.gz","path":"third_party/sources/openssl-1.1.1u.tar.gz","contentType":"file"},{"name":"openssl-3.0.9.tar.gz","path":"third_party/sources/openssl-3.0.9.tar.gz","contentType":"file"},{"name":"pkcs11-helper-1.27.0.tar.bz2","path":"third_party/sources/pkcs11-helper-1.27.0.tar.bz2","contentType":"file"}],"totalCount":10},"third_party":{"items":[{"name":"makefiles","path":"third_party/makefiles","contentType":"directory"},{"name":"sources","path":"third_party/sources","contentType":"directory"},{"name":"tap-notarized.kext","path":"third_party/tap-notarized.kext","contentType":"directory"},{"name":"tun-notarized.kext","path":"third_party/tun-notarized.kext","contentType":"directory"},{"name":"Makefile","path":"third_party/Makefile","contentType":"file"},{"name":"README.txt","path":"third_party/README.txt","contentType":"file"},{"name":"ShellScriptToInstallAutomake1.16.3.sh","path":"third_party/ShellScriptToInstallAutomake1.16.3.sh","contentType":"file"},{"name":"ShellScriptToInstallAutotools.sh","path":"third_party/ShellScriptToInstallAutotools.sh","contentType":"file"}],"totalCount":8},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"third_party","path":"third_party","contentType":"directory"},{"name":"tunnelblick","path":"tunnelblick","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"Building Tunnelblick from Source Code.markdown","path":"Building Tunnelblick from Source Code.markdown","contentType":"file"},{"name":"COPYING","path":"COPYING","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"}],"totalCount":7}},"fileTreeProcessingTime":22.333592,"foldersToFetch":[],"reducedMotionEnabled":"system","repo":{"id":39261898,"defaultBranch":"master","name":"Tunnelblick","ownerLogin":"Tunnelblick","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2015-07-17T18:45:13.000+03:00","ownerAvatar":"https://avatars.githubusercontent.com/u/11572542?v=4","public":true,"private":false,"isOrgOwned":true},"refInfo":{"name":"master","listCacheKey":"v0:1685891090.3087192","canEdit":true,"refType":"branch","currentOid":"c3f162ccb16bdf2d831f23d803b6c14c20ad5ec0"},"path":"third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff","currentUser":{"id":77547197,"login":"MotazHakim","userEmail":"motazhakim@outlook.com"},"blob":{"rawBlob":"diff -u -r -x .DS_Store openvpn-2.6.2.old/src/openvpn/socket.h openvpn-2.6.2.new/src/openvpn/socket.h\n--- openvpn-2.6.2.old/src/openvpn/socket.h\t2023-04-24 13:02:02.000000000 -0400\n+++ openvpn-2.6.2.new/src/openvpn/socket.h\t2023-04-24 13:02:02.000000000 -0400\n@@ -246,6 +246,10 @@\n #endif\n };\n \n+int buffer_mask(struct buffer *buf, const char *xormask, int xormasklen);\n+int buffer_xorptrpos(struct buffer *buf);\n+int buffer_reverse(struct buffer *buf);\n+\n /*\n  * Some Posix/Win32 differences.\n  */\n@@ -1067,32 +1071,58 @@\n static inline int\n link_socket_read(struct link_socket *sock,\n                  struct buffer *buf,\n-                 struct link_socket_actual *from)\n+                 struct link_socket_actual *from,\n+                 int xormethod,\n+                 const char *xormask,\n+                 int xormasklen)\n {\n+    int res;\n     if (proto_is_udp(sock->info.proto) || socket_is_dco_win(sock))\n     /* unified UDPv4 and UDPv6, for DCO-WIN the kernel\n      * will strip the length header */\n     {\n-        int res;\n \n #ifdef _WIN32\n         res = link_socket_read_udp_win32(sock, buf, from);\n #else\n         res = link_socket_read_udp_posix(sock, buf, from);\n #endif\n-        return res;\n     }\n     else if (proto_is_tcp(sock->info.proto)) /* unified TCPv4 and TCPv6 */\n     {\n         /* from address was returned by accept */\n         from->dest = sock->info.lsa->actual.dest;\n-        return link_socket_read_tcp(sock, buf);\n+        res = link_socket_read_tcp(sock, buf);\n     }\n     else\n     {\n         ASSERT(0);\n         return -1; /* NOTREACHED */\n     }\n+    switch(xormethod)\n+    {\n+        case 0:\n+            break;\n+        case 1:\n+            buffer_mask(buf,xormask,xormasklen);\n+            break;\n+        case 2:\n+            buffer_xorptrpos(buf);\n+            break;\n+        case 3:\n+            buffer_reverse(buf);\n+            break;\n+        case 4:\n+            buffer_mask(buf,xormask,xormasklen);\n+            buffer_xorptrpos(buf);\n+            buffer_reverse(buf);\n+            buffer_xorptrpos(buf);\n+            break;\n+        default:\n+            ASSERT (0);\n+            return -1; /* NOTREACHED */\n+    }\n+    return res;\n }\n \n /*\n@@ -1184,8 +1214,34 @@\n static inline int\n link_socket_write(struct link_socket *sock,\n                   struct buffer *buf,\n-                  struct link_socket_actual *to)\n+                  struct link_socket_actual *to,\n+                  int xormethod,\n+                  const char *xormask,\n+                  int xormasklen)\n {\n+    switch(xormethod)\n+    {\n+        case 0:\n+            break;\n+        case 1:\n+            buffer_mask(buf,xormask,xormasklen);\n+            break;\n+        case 2:\n+            buffer_xorptrpos(buf);\n+            break;\n+        case 3:\n+            buffer_reverse(buf);\n+            break;\n+        case 4:\n+            buffer_xorptrpos(buf);\n+            buffer_reverse(buf);\n+            buffer_xorptrpos(buf);\n+            buffer_mask(buf,xormask,xormasklen);\n+            break;\n+        default:\n+            ASSERT (0);\n+            return -1; /* NOTREACHED */\n+    }\n     if (proto_is_udp(sock->info.proto) || socket_is_dco_win(sock))\n     {\n         /* unified UDPv4, UDPv6 and DCO-WIN (driver adds length header) */\n","colorizedLines":null,"stylingDirectives":[[{"start":0,"end":101,"cssClass":"pl-c1"}],[{"start":0,"end":78,"cssClass":"pl-md"}],[{"start":0,"end":78,"cssClass":"pl-mi1"}],[{"start":0,"end":20,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":74,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":42,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":1,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[{"start":0,"end":23,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":50,"cssClass":"pl-md"},{"start":0,"end":1,"cssClass":"pl-md"}],[{"start":0,"end":50,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":32,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":38,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":33,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[{"start":0,"end":13,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[],[{"start":0,"end":17,"cssClass":"pl-md"},{"start":0,"end":1,"cssClass":"pl-md"}],[],[],[],[],[],[],[{"start":0,"end":20,"cssClass":"pl-md"},{"start":0,"end":1,"cssClass":"pl-md"}],[],[],[],[],[],[{"start":0,"end":48,"cssClass":"pl-md"},{"start":0,"end":1,"cssClass":"pl-md"}],[{"start":0,"end":47,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[],[],[],[{"start":0,"end":22,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":49,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":35,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":33,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":49,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":35,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":33,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":35,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":17,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":24,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[{"start":0,"end":22,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":49,"cssClass":"pl-md"},{"start":0,"end":1,"cssClass":"pl-md"}],[{"start":0,"end":49,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":33,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":34,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[{"start":0,"end":22,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":49,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":35,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":33,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":35,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":33,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":35,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":49,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":17,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":24,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/Tunnelblick/Tunnelblick/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/Tunnelblick/Tunnelblick/security/dependabot","repoSecurityAndAnalysisPath":"/Tunnelblick/Tunnelblick/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":false},"displayName":"06-tunnelblick-openvpn_xorpatch-e.diff","displayUrl":"https://github.com/Tunnelblick/Tunnelblick/blob/master/third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff?raw=true","headerInfo":{"blobSize":"3.19 KB","deleteInfo":{"deletePath":"https://github.com/Tunnelblick/Tunnelblick/delete/master/third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff","deleteTooltip":"Fork this repository and delete the file"},"editInfo":{"editTooltip":"Fork this repository and edit the file"},"ghDesktopPath":"x-github-client://openRepo/https://github.com/Tunnelblick/Tunnelblick?branch=master&filepath=third_party%2Fsources%2Fopenvpn%2Fopenvpn-2.6.4%2Fpatches%2F06-tunnelblick-openvpn_xorpatch-e.diff","gitLfsPath":null,"onBranch":true,"shortPath":"1cd714c","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2FTunnelblick%2FTunnelblick%2Fblob%2Fmaster%2Fthird_party%2Fsources%2Fopenvpn%2Fopenvpn-2.6.4%2Fpatches%2F06-tunnelblick-openvpn_xorpatch-e.diff","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"113","truncatedSloc":"110"},"mode":"file"},"image":false,"isCodeownersFile":null,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Diff","large":false,"loggedIn":true,"newDiscussionPath":"/Tunnelblick/Tunnelblick/discussions/new","newIssuePath":"/Tunnelblick/Tunnelblick/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/Tunnelblick/Tunnelblick/blob/master/third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/Tunnelblick/Tunnelblick/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"Tunnelblick","repoName":"Tunnelblick","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"csrf_tokens":{"/Tunnelblick/Tunnelblick/branches":{"post":"iPES84j141CNQlggYLTvcgCC-JTyunZDBJbpsLzaFqcJ5oogOxgvKdyUqjRC7Qwq1TyqhmSp6Bk16jcadlSzDQ"}}},"title":"Tunnelblick/third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff at master Â· Tunnelblick/Tunnelblick","locale":"en"}