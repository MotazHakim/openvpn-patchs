{"payload":{"allShortcutsEnabled":true,"fileTree":{"third_party/sources/openvpn/openvpn-2.6.4/patches":{"items":[{"name":"02-tunnelblick-openvpn_xorpatch-a.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/02-tunnelblick-openvpn_xorpatch-a.diff","contentType":"file"},{"name":"03-tunnelblick-openvpn_xorpatch-b.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff","contentType":"file"},{"name":"04-tunnelblick-openvpn_xorpatch-c.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/04-tunnelblick-openvpn_xorpatch-c.diff","contentType":"file"},{"name":"05-tunnelblick-openvpn_xorpatch-d.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff","contentType":"file"},{"name":"06-tunnelblick-openvpn_xorpatch-e.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff","contentType":"file"},{"name":"10-route-gateway-dhcp.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/10-route-gateway-dhcp.diff","contentType":"file"},{"name":"11-apple-iouserethernet.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/11-apple-iouserethernet.diff","contentType":"file"}],"totalCount":7},"third_party/sources/openvpn/openvpn-2.6.4":{"items":[{"name":"patches","path":"third_party/sources/openvpn/openvpn-2.6.4/patches","contentType":"directory"},{"name":"configure-options.txt","path":"third_party/sources/openvpn/openvpn-2.6.4/configure-options.txt","contentType":"file"},{"name":"openvpn-2.6.4.tar.gz","path":"third_party/sources/openvpn/openvpn-2.6.4/openvpn-2.6.4.tar.gz","contentType":"file"}],"totalCount":3},"third_party/sources/openvpn":{"items":[{"name":"openvpn-2.4.12","path":"third_party/sources/openvpn/openvpn-2.4.12","contentType":"directory"},{"name":"openvpn-2.5.9","path":"third_party/sources/openvpn/openvpn-2.5.9","contentType":"directory"},{"name":"openvpn-2.6.4","path":"third_party/sources/openvpn/openvpn-2.6.4","contentType":"directory"}],"totalCount":3},"third_party/sources":{"items":[{"name":"easy-rsa","path":"third_party/sources/easy-rsa","contentType":"directory"},{"name":"openvpn","path":"third_party/sources/openvpn","contentType":"directory"},{"name":"patches","path":"third_party/sources/patches","contentType":"directory"},{"name":"tuntap","path":"third_party/sources/tuntap","contentType":"directory"},{"name":"Sparkle-077c64419f9460263bad99ab24dff962a103b1e2.zip","path":"third_party/sources/Sparkle-077c64419f9460263bad99ab24dff962a103b1e2.zip","contentType":"file"},{"name":"lz4-1.9.3.tar.gz","path":"third_party/sources/lz4-1.9.3.tar.gz","contentType":"file"},{"name":"lzo-2.10.tar.gz","path":"third_party/sources/lzo-2.10.tar.gz","contentType":"file"},{"name":"openssl-1.1.1u.tar.gz","path":"third_party/sources/openssl-1.1.1u.tar.gz","contentType":"file"},{"name":"openssl-3.0.9.tar.gz","path":"third_party/sources/openssl-3.0.9.tar.gz","contentType":"file"},{"name":"pkcs11-helper-1.27.0.tar.bz2","path":"third_party/sources/pkcs11-helper-1.27.0.tar.bz2","contentType":"file"}],"totalCount":10},"third_party":{"items":[{"name":"makefiles","path":"third_party/makefiles","contentType":"directory"},{"name":"sources","path":"third_party/sources","contentType":"directory"},{"name":"tap-notarized.kext","path":"third_party/tap-notarized.kext","contentType":"directory"},{"name":"tun-notarized.kext","path":"third_party/tun-notarized.kext","contentType":"directory"},{"name":"Makefile","path":"third_party/Makefile","contentType":"file"},{"name":"README.txt","path":"third_party/README.txt","contentType":"file"},{"name":"ShellScriptToInstallAutomake1.16.3.sh","path":"third_party/ShellScriptToInstallAutomake1.16.3.sh","contentType":"file"},{"name":"ShellScriptToInstallAutotools.sh","path":"third_party/ShellScriptToInstallAutotools.sh","contentType":"file"}],"totalCount":8},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"third_party","path":"third_party","contentType":"directory"},{"name":"tunnelblick","path":"tunnelblick","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"Building Tunnelblick from Source Code.markdown","path":"Building Tunnelblick from Source Code.markdown","contentType":"file"},{"name":"COPYING","path":"COPYING","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"}],"totalCount":7}},"fileTreeProcessingTime":13.363531,"foldersToFetch":[],"reducedMotionEnabled":"system","repo":{"id":39261898,"defaultBranch":"master","name":"Tunnelblick","ownerLogin":"Tunnelblick","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2015-07-17T18:45:13.000+03:00","ownerAvatar":"https://avatars.githubusercontent.com/u/11572542?v=4","public":true,"private":false,"isOrgOwned":true},"refInfo":{"name":"master","listCacheKey":"v0:1685891090.3087192","canEdit":true,"refType":"branch","currentOid":"c3f162ccb16bdf2d831f23d803b6c14c20ad5ec0"},"path":"third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff","currentUser":{"id":77547197,"login":"MotazHakim","userEmail":"motazhakim@outlook.com"},"blob":{"rawBlob":"diff -u -r -x .DS_Store openvpn-2.6.2.old/src/openvpn/options.c openvpn-2.6.2.new/src/openvpn/options.c\n--- openvpn-2.6.2.old/src/openvpn/options.c\t2023-04-24 12:28:08.000000000 -0400\n+++ openvpn-2.6.2.new/src/openvpn/options.c\t2023-04-24 12:28:08.000000000 -0400\n@@ -837,6 +837,9 @@\n     o->resolve_retry_seconds = RESOLV_RETRY_INFINITE;\n     o->resolve_in_advance = false;\n     o->proto_force = -1;\n+    o->ce.xormethod = 0;\n+    o->ce.xormask = \"\\0\";\n+    o->ce.xormasklen = 0;\n     o->occ = true;\n #ifdef ENABLE_MANAGEMENT\n     o->management_log_history_cache = 250;\n@@ -999,6 +1002,9 @@\n     setenv_str_i(es, \"local_port\", e->local_port, i);\n     setenv_str_i(es, \"remote\", e->remote, i);\n     setenv_str_i(es, \"remote_port\", e->remote_port, i);\n+    setenv_int_i(es, \"xormethod\", e->xormethod, i);\n+    setenv_str_i(es, \"xormask\", e->xormask, i);\n+    setenv_int_i(es, \"xormasklen\", e->xormasklen, i);\n \n     if (e->http_proxy_options)\n     {\n@@ -1724,6 +1730,9 @@\n     SHOW_BOOL(bind_ipv6_only);\n     SHOW_INT(connect_retry_seconds);\n     SHOW_INT(connect_timeout);\n+    SHOW_INT (xormethod);\n+    SHOW_STR (xormask);\n+    SHOW_INT (xormasklen);\n \n     if (o->http_proxy_options)\n     {\n@@ -6757,6 +6766,46 @@\n         }\n         options->proto_force = proto_force;\n     }\n+    else if (streq (p[0], \"scramble\") && p[1])\n+    {\n+        VERIFY_PERMISSION (OPT_P_GENERAL|OPT_P_CONNECTION);\n+        if (streq (p[1], \"xormask\") && p[2] && (!p[3]))\n+        {\n+            options->ce.xormethod = 1;\n+            options->ce.xormask = p[2];\n+            options->ce.xormasklen = strlen(options->ce.xormask);\n+        }\n+        else if (streq (p[1], \"xorptrpos\") && (!p[2]))\n+        {\n+            options->ce.xormethod = 2;\n+            options->ce.xormask = NULL;\n+            options->ce.xormasklen = 0;\n+        }\n+        else if (streq (p[1], \"reverse\") && (!p[2]))\n+        {\n+            options->ce.xormethod = 3;\n+            options->ce.xormask = NULL;\n+            options->ce.xormasklen = 0;\n+        }\n+        else if (streq (p[1], \"obfuscate\") && p[2] && (!p[3]))\n+        {\n+            options->ce.xormethod = 4;\n+            options->ce.xormask = p[2];\n+            options->ce.xormasklen = strlen(options->ce.xormask);\n+        }\n+        else if (!p[2])\n+        {\n+            msg (M_WARN, \"WARNING: No recognized 'scramble' method specified; using 'scramble xormask \\\"%s\\\"'\", p[1]);\n+            options->ce.xormethod = 1;\n+            options->ce.xormask = p[1];\n+            options->ce.xormasklen = strlen(options->ce.xormask);\n+        }\n+        else\n+        {\n+            msg (msglevel, \"No recognized 'scramble' method specified or extra parameters for 'scramble'\");\n+            goto err;\n+        }\n+    }\n     else if (streq(p[0], \"http-proxy\") && p[1] && !p[5])\n     {\n         struct http_proxy_options *ho;\n","colorizedLines":null,"stylingDirectives":[[{"start":0,"end":103,"cssClass":"pl-c1"}],[{"start":0,"end":79,"cssClass":"pl-md"}],[{"start":0,"end":79,"cssClass":"pl-mi1"}],[{"start":0,"end":19,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":25,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":26,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":26,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[{"start":0,"end":20,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":52,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":48,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":54,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[{"start":0,"end":21,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":26,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":24,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":27,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[],[{"start":0,"end":22,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":47,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":60,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":56,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":66,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":55,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":53,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":63,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":66,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":24,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":119,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":66,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":13,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":108,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":22,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/Tunnelblick/Tunnelblick/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/Tunnelblick/Tunnelblick/security/dependabot","repoSecurityAndAnalysisPath":"/Tunnelblick/Tunnelblick/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":false},"displayName":"03-tunnelblick-openvpn_xorpatch-b.diff","displayUrl":"https://github.com/Tunnelblick/Tunnelblick/blob/master/third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff?raw=true","headerInfo":{"blobSize":"2.78 KB","deleteInfo":{"deletePath":"https://github.com/Tunnelblick/Tunnelblick/delete/master/third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff","deleteTooltip":"Fork this repository and delete the file"},"editInfo":{"editTooltip":"Fork this repository and edit the file"},"ghDesktopPath":"x-github-client://openRepo/https://github.com/Tunnelblick/Tunnelblick?branch=master&filepath=third_party%2Fsources%2Fopenvpn%2Fopenvpn-2.6.4%2Fpatches%2F03-tunnelblick-openvpn_xorpatch-b.diff","gitLfsPath":null,"onBranch":true,"shortPath":"1b9778f","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2FTunnelblick%2FTunnelblick%2Fblob%2Fmaster%2Fthird_party%2Fsources%2Fopenvpn%2Fopenvpn-2.6.4%2Fpatches%2F03-tunnelblick-openvpn_xorpatch-b.diff","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"80","truncatedSloc":"78"},"mode":"file"},"image":false,"isCodeownersFile":null,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Diff","large":false,"loggedIn":true,"newDiscussionPath":"/Tunnelblick/Tunnelblick/discussions/new","newIssuePath":"/Tunnelblick/Tunnelblick/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/Tunnelblick/Tunnelblick/blob/master/third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/Tunnelblick/Tunnelblick/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"Tunnelblick","repoName":"Tunnelblick","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"csrf_tokens":{"/Tunnelblick/Tunnelblick/branches":{"post":"k4pyYuE7TXoNDaQo5mZPg_l2wNYjQu5zQDI3Tl3BkyMSneqxUtaBA1zbVjzEP6zbLMiSxLVRcClxTunkl082iQ"}}},"title":"Tunnelblick/third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff at master Â· Tunnelblick/Tunnelblick","locale":"en"}