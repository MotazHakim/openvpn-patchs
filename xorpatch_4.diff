{"payload":{"allShortcutsEnabled":true,"fileTree":{"third_party/sources/openvpn/openvpn-2.6.4/patches":{"items":[{"name":"02-tunnelblick-openvpn_xorpatch-a.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/02-tunnelblick-openvpn_xorpatch-a.diff","contentType":"file"},{"name":"03-tunnelblick-openvpn_xorpatch-b.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/03-tunnelblick-openvpn_xorpatch-b.diff","contentType":"file"},{"name":"04-tunnelblick-openvpn_xorpatch-c.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/04-tunnelblick-openvpn_xorpatch-c.diff","contentType":"file"},{"name":"05-tunnelblick-openvpn_xorpatch-d.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff","contentType":"file"},{"name":"06-tunnelblick-openvpn_xorpatch-e.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/06-tunnelblick-openvpn_xorpatch-e.diff","contentType":"file"},{"name":"10-route-gateway-dhcp.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/10-route-gateway-dhcp.diff","contentType":"file"},{"name":"11-apple-iouserethernet.diff","path":"third_party/sources/openvpn/openvpn-2.6.4/patches/11-apple-iouserethernet.diff","contentType":"file"}],"totalCount":7},"third_party/sources/openvpn/openvpn-2.6.4":{"items":[{"name":"patches","path":"third_party/sources/openvpn/openvpn-2.6.4/patches","contentType":"directory"},{"name":"configure-options.txt","path":"third_party/sources/openvpn/openvpn-2.6.4/configure-options.txt","contentType":"file"},{"name":"openvpn-2.6.4.tar.gz","path":"third_party/sources/openvpn/openvpn-2.6.4/openvpn-2.6.4.tar.gz","contentType":"file"}],"totalCount":3},"third_party/sources/openvpn":{"items":[{"name":"openvpn-2.4.12","path":"third_party/sources/openvpn/openvpn-2.4.12","contentType":"directory"},{"name":"openvpn-2.5.9","path":"third_party/sources/openvpn/openvpn-2.5.9","contentType":"directory"},{"name":"openvpn-2.6.4","path":"third_party/sources/openvpn/openvpn-2.6.4","contentType":"directory"}],"totalCount":3},"third_party/sources":{"items":[{"name":"easy-rsa","path":"third_party/sources/easy-rsa","contentType":"directory"},{"name":"openvpn","path":"third_party/sources/openvpn","contentType":"directory"},{"name":"patches","path":"third_party/sources/patches","contentType":"directory"},{"name":"tuntap","path":"third_party/sources/tuntap","contentType":"directory"},{"name":"Sparkle-077c64419f9460263bad99ab24dff962a103b1e2.zip","path":"third_party/sources/Sparkle-077c64419f9460263bad99ab24dff962a103b1e2.zip","contentType":"file"},{"name":"lz4-1.9.3.tar.gz","path":"third_party/sources/lz4-1.9.3.tar.gz","contentType":"file"},{"name":"lzo-2.10.tar.gz","path":"third_party/sources/lzo-2.10.tar.gz","contentType":"file"},{"name":"openssl-1.1.1u.tar.gz","path":"third_party/sources/openssl-1.1.1u.tar.gz","contentType":"file"},{"name":"openssl-3.0.9.tar.gz","path":"third_party/sources/openssl-3.0.9.tar.gz","contentType":"file"},{"name":"pkcs11-helper-1.27.0.tar.bz2","path":"third_party/sources/pkcs11-helper-1.27.0.tar.bz2","contentType":"file"}],"totalCount":10},"third_party":{"items":[{"name":"makefiles","path":"third_party/makefiles","contentType":"directory"},{"name":"sources","path":"third_party/sources","contentType":"directory"},{"name":"tap-notarized.kext","path":"third_party/tap-notarized.kext","contentType":"directory"},{"name":"tun-notarized.kext","path":"third_party/tun-notarized.kext","contentType":"directory"},{"name":"Makefile","path":"third_party/Makefile","contentType":"file"},{"name":"README.txt","path":"third_party/README.txt","contentType":"file"},{"name":"ShellScriptToInstallAutomake1.16.3.sh","path":"third_party/ShellScriptToInstallAutomake1.16.3.sh","contentType":"file"},{"name":"ShellScriptToInstallAutotools.sh","path":"third_party/ShellScriptToInstallAutotools.sh","contentType":"file"}],"totalCount":8},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"third_party","path":"third_party","contentType":"directory"},{"name":"tunnelblick","path":"tunnelblick","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"Building Tunnelblick from Source Code.markdown","path":"Building Tunnelblick from Source Code.markdown","contentType":"file"},{"name":"COPYING","path":"COPYING","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"}],"totalCount":7}},"fileTreeProcessingTime":44.281399,"foldersToFetch":[],"reducedMotionEnabled":"system","repo":{"id":39261898,"defaultBranch":"master","name":"Tunnelblick","ownerLogin":"Tunnelblick","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2015-07-17T18:45:13.000+03:00","ownerAvatar":"https://avatars.githubusercontent.com/u/11572542?v=4","public":true,"private":false,"isOrgOwned":true},"refInfo":{"name":"master","listCacheKey":"v0:1685891090.3087192","canEdit":true,"refType":"branch","currentOid":"c3f162ccb16bdf2d831f23d803b6c14c20ad5ec0"},"path":"third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff","currentUser":{"id":77547197,"login":"MotazHakim","userEmail":"motazhakim@outlook.com"},"blob":{"rawBlob":"diff -u -r -x .DS_Store openvpn-2.6.0.old/src/openvpn/socket.c openvpn-2.6.0.new/src/openvpn/socket.c\n--- openvpn-2.6.0.old/src/openvpn/socket.c\t2023-02-07 17:53:58.000000000 -0500\n+++ openvpn-2.6.0.new/src/openvpn/socket.c\t2023-02-07 17:53:58.000000000 -0500\n@@ -61,6 +61,56 @@\n     }\n }\n \n+int buffer_mask(struct buffer *buf, const char *mask, int xormasklen)\n+{\n+    int i;\n+    uint8_t *b;\n+    if (  xormasklen > 0  ) {\n+        for (i = 0, b = BPTR (buf); i < BLEN(buf); i++, b++) {\n+            *b = *b ^ mask[i % xormasklen];\n+        }\n+    }\n+    return BLEN (buf);\n+}\n+\n+int buffer_xorptrpos(struct buffer *buf)\n+{\n+    int i;\n+    uint8_t *b;\n+    for (i = 0, b = BPTR (buf); i < BLEN(buf); i++, b++) {\n+        *b = *b ^ i+1;\n+    }\n+    return BLEN (buf);\n+}\n+\n+int buffer_reverse(struct buffer *buf)\n+{\n+/* This function has been rewritten for Tunnelblick. The buffer_reverse function at\n+ * https://github.com/clayface/openvpn_xorpatch\n+ * makes a copy of the buffer and it writes to the byte **after** the\n+ * buffer contents, so if the buffer is full then it writes outside of the buffer.\n+ * This rewritten version does neither.\n+ *\n+ * For interoperability, this rewritten version preserves the behavior of the original\n+ * function: it does not modify the first character of the buffer. So it does not\n+ * actually reverse the contents of the buffer. Instead, it changes 'abcde' to 'aedcb'.\n+ * (Of course, the actual buffer contents are bytes, and not necessarily characters.)\n+ */\n+    int len = BLEN(buf);\n+    if (  len > 2  ) {                           /* Leave '', 'a', and 'ab' alone */\n+        int i;\n+        uint8_t *b_start = BPTR (buf) + 1;            /* point to first byte to swap */\n+        uint8_t *b_end   = BPTR (buf) + (len - 1); /* point to last byte to swap */\n+        uint8_t tmp;\n+        for (i = 0; i < (len-1)/2; i++, b_start++, b_end--) {\n+            tmp = *b_start;\n+            *b_start = *b_end;\n+            *b_end = tmp;\n+        }\n+    }\n+    return len;\n+}\n+\n /*\n  * Functions related to the translation of DNS names to IP addresses.\n  */\n","colorizedLines":null,"stylingDirectives":[[{"start":0,"end":101,"cssClass":"pl-c1"}],[{"start":0,"end":78,"cssClass":"pl-md"}],[{"start":0,"end":78,"cssClass":"pl-mi1"}],[{"start":0,"end":18,"cssClass":"pl-mdr"}],[],[],[],[{"start":0,"end":70,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":2,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":11,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":30,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":63,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":44,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":23,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":2,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":1,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":41,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":2,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":11,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":59,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":23,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":23,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":2,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":1,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":39,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":2,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":84,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":48,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":70,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":83,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":40,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":3,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":87,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":82,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":88,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":86,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":4,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":25,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":85,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":15,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":88,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":84,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":21,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":62,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":28,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":31,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":26,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":10,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":6,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":16,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":2,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[{"start":0,"end":1,"cssClass":"pl-mi1"},{"start":0,"end":1,"cssClass":"pl-mi1"}],[],[],[]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/Tunnelblick/Tunnelblick/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/Tunnelblick/Tunnelblick/security/dependabot","repoSecurityAndAnalysisPath":"/Tunnelblick/Tunnelblick/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":false},"displayName":"05-tunnelblick-openvpn_xorpatch-d.diff","displayUrl":"https://github.com/Tunnelblick/Tunnelblick/blob/master/third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff?raw=true","headerInfo":{"blobSize":"2.05 KB","deleteInfo":{"deletePath":"https://github.com/Tunnelblick/Tunnelblick/delete/master/third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff","deleteTooltip":"Fork this repository and delete the file"},"editInfo":{"editTooltip":"Fork this repository and edit the file"},"ghDesktopPath":"x-github-client://openRepo/https://github.com/Tunnelblick/Tunnelblick?branch=master&filepath=third_party%2Fsources%2Fopenvpn%2Fopenvpn-2.6.4%2Fpatches%2F05-tunnelblick-openvpn_xorpatch-d.diff","gitLfsPath":null,"onBranch":true,"shortPath":"bc4e5bd","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2FTunnelblick%2FTunnelblick%2Fblob%2Fmaster%2Fthird_party%2Fsources%2Fopenvpn%2Fopenvpn-2.6.4%2Fpatches%2F05-tunnelblick-openvpn_xorpatch-d.diff","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"60","truncatedSloc":"59"},"mode":"file"},"image":false,"isCodeownersFile":null,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Diff","large":false,"loggedIn":true,"newDiscussionPath":"/Tunnelblick/Tunnelblick/discussions/new","newIssuePath":"/Tunnelblick/Tunnelblick/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/Tunnelblick/Tunnelblick/blob/master/third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/Tunnelblick/Tunnelblick/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"Tunnelblick","repoName":"Tunnelblick","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"csrf_tokens":{"/Tunnelblick/Tunnelblick/branches":{"post":"b45ufqU1gi_8QvBgklLx_NRdC7vP4w9RP4r5nnM6-XHumfatFthOVq2UAnSwCxKkAeNZqVnwkQsO9ic0ubRc2w"}}},"title":"Tunnelblick/third_party/sources/openvpn/openvpn-2.6.4/patches/05-tunnelblick-openvpn_xorpatch-d.diff at master Â· Tunnelblick/Tunnelblick","locale":"en"}